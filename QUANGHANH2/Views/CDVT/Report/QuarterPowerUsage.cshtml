@{
    ViewData["Title"] = "Báo cáo sử dụng điện năng theo Quý";
    Layout = "~/Views/Shared/_Layout_CDVT.cshtml";
}

<link href="~/assets/Custom css/TABLE_BORDERED.css" rel="stylesheet" />
<link href="~/assets/extra-libs/prism/prism.css" rel="stylesheet" />
<link href="~/lib/datepicker_src/dist/css/datepicker.min.css" rel="stylesheet" type="text/css">
<link href="~/lib/datepicker_src/css/style.css" rel="stylesheet " type="text/css ">
<link href="~/lib/datepicker_src/dist/css/datepicker.min.css " rel="stylesheet " type="text/css ">
<link href="~/lib/datepicker_src/dist/css/custom.css " rel="stylesheet " type="text/css ">
<link href="~/lib/datepicker_src/dist/css/font.css" rel="stylesheet" type="text/css">
<script src="~/lib/datepicker_src/dist/js/datepicker.js"></script>
<script src="~/lib/datepicker_src/dist/js/i18n/datepicker.vi.js"></script>
<script src="~/assets/extra-libs/prism/prism.js"></script>
<script>
    $(function () {
        var url_string = window.location.href;
        var url = new URL(url_string);
        $("#txtmonth").datepicker({
            onSelect: function () {
                $('#pre-load').show();
                var val = document.getElementById("txtmonth").value;
                var val2 = val.split(" ");
                window.location = "/phong-cdvt/bao-cao/dien-nang?type=month&month=" + val2[1] + "&year=" + val2[2];
            }
        })
        $("#txtyear").datepicker({
            onSelect: function () {
                $('#pre-load').show();
                window.location = "/phong-cdvt/bao-cao/dien-nang?type=year&year=" + document.getElementById("txtyear").value;
            }
        })
        $("#minMaxDate").datepicker({
            onSelect: function () {
                $('#pre-load').show();
                window.location = "/phong-cdvt/bao-cao/dien-nang?type=day&date=" + document.getElementById("minMaxDate").value;
            }
        })
        $('#txtquarter').change(function () {
            $('#pre-load').show();
            window.location = "/phong-cdvt/bao-cao/dien-nang?type=quarter&quarter=" + document.getElementById("txtquarter").value + "&year=" + document.getElementById("quateryear").value;
        });
        $("#quateryear").datepicker({
            onSelect: function () {
                $('#pre-load').show();
                window.location = "/phong-cdvt/bao-cao/dien-nang?type=quarter&quarter=" + document.getElementById("txtquarter").value + "&year=" + document.getElementById("quateryear").value;
            }
        })
    });
    $(document).ready(function () {
      
        var url_string = window.location.href;
        var url = new URL(url_string);
        var c = url.searchParams.get("type");
        var day = url.searchParams.get("date");
        var month = url.searchParams.get("month");
        var quater = url.searchParams.get("quarter");
        var year = url.searchParams.get("year");
          $("#minMaxDate").val("@string.Format("{0:dd/MM/yyyy}", System.DateTime.Now)");
        $("#txtmonth").val("Tháng @DateTime.Now.Month @DateTime.Now.Year");
        $("#txtyear").val("@DateTime.Now.Year");
        $("#quateryear").val("@DateTime.Now.Year");
        $("#type").html("Xem Theo Ngày");

        if (c == "day") {
            document.getElementById("typeview").innerText = "Xem Theo Ngày";
            document.getElementById("visiblequater").style.display = "none";
            document.getElementById("visibleyear").style.display = "none";
            document.getElementById("visiblemonth").style.display = "none";
            document.getElementById("visibleday").style.display = "inline";
            $("#minMaxDate").val(day);
        }
        if (c == "month") {
            document.getElementById("typeview").innerText = "Xem Theo Tháng";
            document.getElementById("visibleday").style.display = "none";
            document.getElementById("visiblequater").style.display = "none";
            document.getElementById("visibleyear").style.display = "none";
            document.getElementById("visiblemonth").style.display = "inline";
            $("#txtmonth").val("Tháng " + month +" "+ year);
        }
        if (c == "quarter") {
            document.getElementById("typeview").innerText = "Xem Theo Quý";
            document.getElementById("visibleday").style.display = "none";
            document.getElementById("visibleyear").style.display = "none";
            document.getElementById("visiblemonth").style.display = "none";
            document.getElementById("visiblequater").style.display = "inline";
            document.getElementById('txtquarter').selectedIndex = quater - 1;
            $("#quateryear").val(year);
        }
        if (c == "year") {
            document.getElementById("typeview").innerText = "Xem Theo Năm";
            document.getElementById("visibleday").style.display = "none";
            document.getElementById("visiblemonth").style.display = "none";
            document.getElementById("visiblequater").style.display = "none";
            document.getElementById("visibleyear").style.display = "inline";
            $("#txtyear").val(year);
        }
    });

</script>
<div class="card">
    <div class="card-content">
        <div class="col s12">
            <div class="center">
                <h3 class="centered" style="padding-top:20px"><b>BÁO CÁO SỬ DỤNG NĂNG LƯỢNG ĐIỆN</b></h3>
                <div class="day" id="visibleday">
                    <h3>
                        <i class="fas fa-calendar-alt icon"></i>
                        <input type='text' class='datepicker-here center' id="minMaxDate" data-language='vi'/>
                    </h3>
                </div>
                <div class="month" id="visiblemonth" style="display: none">
                    <h3>
                        <i class="fas fa-calendar-alt icon"></i>
                        <input type="text"
                               id="txtmonth"
                               class="datepicker-here center"
                               data-language='vi'
                               data-min-view="months"
                               data-view="months"
                               data-date-format="MM yyyy" />
                    </h3>
                </div>
                <div class="quarter" id="visiblequater" style="display: none">
                    <div class="row">
                        <div class="col l4 m4"></div>
                        <div class="col l2 m2 s4">
                            <select class="form-control" style="width: 30%" id="txtquarter">
                                <option value="1">Quý I</option>
                                <option value="2" selected>Quý II</option>
                                <option value="3">Quý III</option>
                                <option value="4">Quý IV</option>
                            </select>
                        </div>
                        <div class="col l2 m2 s6">
                            <input type="text"
                                   id="quateryear"
                                   class="datepicker-here center form-control"
                                   data-language='vi'
                                   data-min-view="years"
                                   data-view="years"
                                   data-date-format="yyyy" value="@DateTime.Now.Year" style="width: 150px !important" />
                        </div>
                    </div>
                </div>
                <div class="year" id="visibleyear" style="display: none">
                    <h3>
                        <i class="fas fa-calendar-alt icon"></i>
                        <input type="text"
                               id="txtyear"
                               class="datepicker-here center"
                               data-language='vi'
                               data-min-view="years"
                               data-view="years"
                               data-date-format="yyyy" />
                    </h3>
                </div>
            </div>

        </div>

        <div class="row">
            <div class="col s12">
                <a id="typeview" class='dropdown-trigger btn' href='#' data-target='dropdown1' style="width:250px;background-color:#273146;margin-bottom:20px">Xem Theo Ngày</a>
            </div>
            <div class="col s12">
                <ul class="tabs">
                    <li class="tab col s6"><a class="active" onclick="ResizeChart()" href="#bieudo"><b>Biểu đồ</b></a></li>
                    <li class="tab col s6"><a href="#solieu"><b>Bảng báo cáo</b></a></li>
                </ul>
            </div>
        </div>

    </div>

</div>
<ul id='dropdown1' class='dropdown-content'>
    <li onclick="ViewbyDay();"><a id="day" href="#" ;>Xem Theo Ngày</a></li>
    <li onclick="ViewbyMonth();"><a id="month" href="#" ;>Xem Theo Tháng</a></li>
    <li onclick="ViewbyQuarter();"><a id="quarter" href="#" ;>Xem Theo Quý</a></li>
    <li onclick="ViewbyYear();"><a id="year" href="#" ;>Xem Theo Năm</a></li>
</ul>


<div id="bieudo">
    <div class="row">
        <div class="col s12 l6">
            <div class="card" style="height: 180px">
                <div class="card-content align-items-center">
                    <div class="row">
                        <div class="col s12">
                            <h6 class="card-subtitle">Điện năng sử dụng</h6>
                            <h4>@ViewBag.Dien kWh</h4>
                        </div>
                        <div class="col s12">
                            <div class="progress">
                                <div class="determinate amber darken+3" style="width: 48%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col s12 l6">
            <div class="card" style="height: 180px">
                <div class="card-content align-items-center">
                    <div class="row">
                        <div class="col s12">
                            <h6 class="card-subtitle">Sản lượng</h6>
                            <h4>@ViewBag.SanLuong tấn</h4>
                        </div>
                        <div class="col s12">
                            <div class="progress">
                                <div class="determinate amber darken+3" style="width: 45%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<div class="card">

    <div class="row">

        <div id="solieu" class="col s12">
            <div class="row ">
                <div class="col l12">
                    <table class="table-bordered table-responsive striped">
                        <thead>
                            <tr>
                                <th class="text-center" rowspan="2">STT</th>
                                <th class="text-center" rowspan="2">Tên thiết bị</th>
                                <th class="text-center" rowspan="2">Mã thiết bị</th>
                                <th class="text-center">Điện năng sử dụng (kWh)</th>
                                <th class="text-center" colspan="2">Sản lượng</th>
                            </tr>
                            <tr>
                                <th>Thực hiện quý II</th>
                                <th>Thực hiện quý II</th>
                                <th>ĐVT</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in ViewBag.ContentReport)
                            {
                                <tr>
                                    <td>@item.Thang/@item.Nam</td>
                                    <td>@item.MaThietBi</td>
                                    <td>@item.TenThietBi</td>
                                    <td>@item.LuongTieuThu</td>
                                    <td>@item.SanLuong</td>
                                    <td>tấn</td>
                                </tr>
                            }
                            <tr style="color:crimson">
                                <td></td>
                                <td></td>
                                <td>Tổng cộng</td>
                                <td>@ViewBag.Dien</td>
                                <td>@ViewBag.SanLuong</td>
                                <td>tấn</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="row" style="margin:20px 0px 20px 0px">
                        <div class="col-lg-12 left">
                            <div class="export_btn_container">
                                <a class="waves-effect waves-light btn mybtn" onclick="window.open('nhien-lieu/excel')">Xuất ra file excel</a>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col l12">
                            <h3>TỔNG HỢP BÁO CÁO: </h3>
                        </div>
                    </div>

                    <div class="row center">
                        <div class="summary_container">
                            <div class="col l8 summary_right">
                                <table class="table table-bordered striped">
                                    <tbody>
                                        <tr>
                                            <th class="total_row">Thực hiện quý II	: </th>
                                            <td class="total_row"></td>
                                        </tr>
                                        <tr>
                                            <th>Điện năng sử dụng</th>
                                            <td>@ViewBag.Dien</td>
                                        </tr>
                                        <tr>
                                            <th>Sản lượng</th>
                                            <td>@ViewBag.SanLuong</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>





<script src="~/js/Custom JS/CDVT/Report/DetailManu.js"></script>
<script src="~/js/Custom JS/CDVT/Report/ChangeDateType.js"></script>
<script type="text/javascript">
    function ViewbyDay() {
        $('#pre-load').show();
        window.location = "/phong-cdvt/bao-cao/dien-nang?type=day&date=" + document.getElementById("minMaxDate").value;
    }
    function ViewbyMonth() {
        $('#pre-load').show();
        var val = document.getElementById("txtmonth").value;
        var val2 = val.split(" ");
        window.location = "/phong-cdvt/bao-cao/dien-nang?type=month&month=" + val2[1] + "&year=" + val2[2];
    }
    function ViewbyQuarter() {
        $('#pre-load').show();
        window.location = "/phong-cdvt/bao-cao/dien-nang?type=quarter&quarter=" + document.getElementById("txtquarter").value + "&year=" + document.getElementById("quateryear").value;
    }
    function ViewbyYear() {
        $('#pre-load').show();
        window.location = "/phong-cdvt/bao-cao/dien-nang?type=year&year=" + document.getElementById("txtyear").value;
    }
</script>

<script src="~/js/Custom JS/CDVT/Report/PowerUsage.js"></script>
<script>
    $('#minMaxDate').datepicker({
        language: 'vi',
        maxDate: new Date() // Now can select only dates, which goes after today
    })
    $(document).ready(function () {
        $('.datepicker-inline').remove();
    });
   
</script>